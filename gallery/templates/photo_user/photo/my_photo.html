{% load staticfiles humanize liked_user %}

<span class="text-hide-xs">
  {% if prev %}
    <span class="prev_item"><svg class="svg_default" style="width:50px;height:50px;" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg></span>
  {% endif %}
  {% if next %}
    <span class="next_item"><svg class="svg_default" style="width:50px;height:50px;" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg></span>
  {% endif %}
</span>

<div class="mb-4 data_display" data-pk="{{ user.pk }}" data-uuid="{{ object.uuid }}">
  <div class="row">
    <div class="col-lg-8 col-md-7 col-sm-12 order-1">
      <div class="card rounded-0 border-0 mb-4">
        {% if object.file %}
          <img style="width: 100%;" src="{{ object.file.url }}" alt="">
        {% else %}
          <svg class="svg_default" style="width:100%;height:auto" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
        {% endif %}
    </div>

      <span id="btn_console">
        <span  style="cursor:pointer" id="user_photo_remove">Удалить</span>
        &nbsp;
        <span>
          {% if avatar %}
            <span style="cursor:pointer" class="u_unset_avatar">Убрать аватар</span>
          {% else %}
            <span style="cursor:pointer" class="u_set_avatar">На аватар</span>
          {% endif %}
        </span>
        &nbsp;
          <span>
            {% if object.is_public %}
            <span style="cursor:pointer" class="u_photo_on_private">Включить приватность</span>
            {% else %}
            <span style="cursor:pointer" class="u_photo_off_private">Отключить приватность</span>
            {% endif %}
          </span>
          &nbsp;
          <span>
            {% if object.comments_enabled %}
              <span style="cursor:pointer" class="u_photo_off_comment">Выключить комментарии</span>
            {% else %}
              <span style="cursor:pointer" class="u_photo_on_comment">Включить комментарии</span>
            {% endif %}
          </span>
      </span>
    </div>
    <div class="col-lg-4 col-md-5 col-sm-12 order-2 ">

      {% include 'photo_user/card_header.html' %}
      <span>
        {% if object.description %}
        {{ object.description }}
        <br>
          <span style="cursor:pointer" class="u_photo_edit">Редактировать</span>
        {% else %}
          <span style="cursor:pointer" class="u_photo_edit">Добавить описание</span>
        {% endif %}
      </span>
      <span id="block_description_form" style="display:none">
        <form action="" method="post">
            {% csrf_token %}
            <div class="row no-gutters">
                <div class="col">
                    <div class="input-group input-group-sm">
                      {{ form_image.description }}
                    </div>
                </div>
                <div class="col-auto">
                    <button class="btn btn-outline-primary btn-rounded btn-sm ml-2" id="u_photo_description_btn" type="button">
                      <svg class="svg_info" fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                    </button>
                </div>
            </div>
        </form>
      </span>
    </div>
  </div>
</div>


  <script>
    {% if prev %}
    $('.prev_item').on('click', function () {uuid = "{{ user.uuid }}";pk = "{{ prev.pk }}";$('#photo_loader').html('').load("/gallery/load/photo/" + pk + "/" + uuid + "/");});
    {% endif %}
    {% if next %}
     $('.next_item').on('click', function () {uuid = "{{ user.uuid }}";pk = "{{ next.pk }}";$('#photo_loader').html('').load("/gallery/load/photo/" + pk + "/" + uuid + "/");});
   {% endif %}

   $('#ajax').on('click', '#user_photo_abort_remove', function() {
       button = $(this);
       display = button.parents(".data_display");
       remove_block = button.parent();
       pk = display.data('pk');
       uuid = display.data('uuid');
       $.ajax({
           url: '/gallery/user_progs/abort_delete/' + pk + "/" + uuid + "/",
           success: function(data) {
             remove_block.empty().append('<span  style="cursor:pointer" id="user_photo_remove">Удалить</span>&nbsp;<span>{% if avatar %}<span style="cursor:pointer" class="u_unset_avatar">Убрать аватар</span>{% else %}<span style="cursor:pointer" class="u_set_avatar">На аватар</span>{% endif %}</span>&nbsp;<span>{% if object.is_public %}<span style="cursor:pointer" class="u_photo_on_private">Включить приватность</span>{% else %}<span style="cursor:pointer" class="u_photo_off_private">Отключить приватность</span>{% endif %}</span>&nbsp;<span>{% if object.comments_enabled %}<span style="cursor:pointer" class="u_photo_off_comment">Выключить комментарии</span>{% else %}<span style="cursor:pointer" class="u_photo_on_comment">Включить комментарии</span>{% endif %}</span>');
             display.removeClass("style_removed_object");
             $.toast({heading: 'Информация',text: 'Фотография успешно восстановлена',showHideTransition: 'fade',icon: 'link'});
           }});
       return false;
   });

   $('#ajax').on('click', '#u_photo_description_btn', function() {
       var button = $(this);
       var form2 = button.parent().parent().parent();
       display = button.parents(".data_display");
       description_block = form2.parent().prev();
       var pk = display.data('pk');
       var uuid = display.data('uuid');
       $.ajax({
           url: '/gallery/user_progs/description/' + pk + "/" + uuid + "/",
           method:"post",
           success: function(data) {
             description = $("#id_description").val();
             description_block.empty().append(description + "<br><br><span style='cursor:pointer' class='u_photo_edit'>Редактировать</span>");
             form2.parent().hide();
           }});
       return false;
   });
  </script>
