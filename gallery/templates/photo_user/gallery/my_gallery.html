{% extends "base.html" %}
{% block title %}Мои фотографии{% endblock %}
{% block content %}

<link rel="stylesheet" href="/static/styles/dropzone.css" />

<div class="container-fluid" style="margin-top:30px">
    <div class="row">
        <div class="col-12 col-md-8">
            <h5 class="mt-1">Мои альбомы</h5> {% if not user.is_album_exists %}- пока нет{% endif %}
        </div>
        <div class="col-12 col-md-4">
          <button class="u_albums_add" data-uuid="{{ user.uuid }}" class="btn btn-outline-success" style="margin-bottom:15px;width:100%" type="button">
            Добавить альбом
          </button>
        </div>
    </div>
</div>

<div class="container mt-4">
      <div id="albums_load"></div>
</div>

<div class="container-fluid" style="margin-top:30px">
    <div class="row">
        <div class="col-12 col-md-8">
            <h5 class="mt-1">Мои фотографии</h5>
            Фото: {{ user.count_photos }}
        </div>
        <div class="col-12 col-md-4">
          <button class="u_photos_add" class="btn btn-outline-success" style="margin-bottom:15px;width:100%" type="button">
            Добавить фотографии
          </button>
        </div>
    </div>
</div>

<div class="container mt-4 main-container">
    <div id="photos_add_window" style="display:none">
        <form id="add-photos" method="post" action="{% url 'photo_add_user' user.uuid %}" class="dropzone">
            {% csrf_token %}
        </form>
        <br><br>
    </div>
      <div id="photo_load" style="width: 100%;"></div>
  </div>

<script>
  ready(() => {
    var link = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject( 'Microsoft.XMLHTTP' );
    link.open( 'GET', '/gallery/user/albums/' + '{{ user.uuid }}', true );
    link.onreadystatechange = function () {
      if ( link.readyState == 4 ) {
          if ( link.status == 200 ) {
              var albums_load = document.getElementById("albums_load");
              albums_load.innerHTML = link.responseText;
          }
      }
  };
  link.send( null );

  var link_2 = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject( 'Microsoft.XMLHTTP' );
  link_2.open( 'GET', '/gallery/user/photos/' + '{{ user.uuid }}', true );
  link_2.onreadystatechange = function () {
    if ( link_2.readyState == 4 ) {
        if ( link_2.status == 200 ) {
            var photo_load = document.getElementById("photo_load");
            photo_load.innerHTML = link_2.responseText;
        }
    }
  };
  link_2.send( null );
  });
</script>

{% include 'photo_user/gallery/dropzone.html' %}
{% endblock %}
