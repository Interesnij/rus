{% extends "base.html" %}
{% load staticfiles liked_user %}
{% block title %}Мои фотографии{% endblock %}
{% block content %}

<link rel="stylesheet" href="{% static 'styles/dropzone.css' %}" />

<div class="container-fluid" style="margin-top:30px">
    <div class="row">
        <div class="col-12 col-md-8">
            <h5 class="mt-1">Мои альбомы</h5>
        </div>
        <div class="col-12 col-md-4">
          <button id="albums_add" data-uuid="{{ user.uuid }}" class="btn btn-outline-success" style="margin-bottom:15px;width:100%" type="button">
            Добавить альбом
          </button>
        </div>
    </div>
</div>

<div class="container mt-4">
      <div id="albums_load"></div>
</div>

<div class="container-fluid" style="margin-top:30px">
    <div class="row">
        <div class="col-12 col-md-8">
            <h5 class="mt-1">Мои фотографии</h5>
            Фото: {{ user.count_photos }}
        </div>
        <div class="col-12 col-md-4">
          <button id="photos_add" class="btn btn-outline-success" style="margin-bottom:15px;width:100%" type="button">
            Добавить фотографии
          </button>
        </div>
    </div>
</div>

<div class="container mt-4 main-container">
    <div id="photos_add_window" style="display:none">
        <form id="add-photos" method="post" action="{% url 'photo_add_user' user.uuid %}" class="dropzone">
            {% csrf_token %}
        </form>
        <br><br>
    </div>
      <div id="photo_load" style="width: 100%;"></div>
  </div>


<div class="card mb-4 add_fullscreen" style="display:none">
    <span class="add_fullscreen_hide">
      <svg class="svg_default" fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
    </span>
    <div id="photo_add_loader" style="margin-top:30px"></div>
</div>

<script defer src="{% static 'scripts/dropzone.js' %}" type="text/javascript"></script>
<script defer src="{% static 'scripts/my/gallery.js' %}" type="text/javascript"></script>
<script>
  $(document).ready(function() {
      $('#albums_load').html('').load("/gallery/user/albums/" + "{{ user.uuid }}");
      $('#photo_load').html('').load("/gallery/user/photos/" + "{{ user.uuid }}");
  });

  $("#photos_add").click(function() { $('#photos_add_window').show(); })
  $("#albums_add").click(function() { var user = $(this); var user_id = user.data("uuid"); $('#photo_add_loader').html('').load("/gallery/user/add_album/" + user_id + "/"); $('.add_fullscreen').show(); })
  $('.add_fullscreen_hide').on('click', function() { $('.add_fullscreen').hide(); $('#photo_loader').empty(); });
  $('.photo_fullscreen_hide').on('click', function() { $('.photo_fullscreen').hide(); $('#photo_loader').empty(); });

  Dropzone.options.inner = {
    init: function() {
      this.on("completemultiple", function(file) {
        console.log("fff");
      })
    },
};
</script>
{% endblock %}
