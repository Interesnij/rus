{% load staticfiles %}
<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{% block title %}{% endblock %}</title>
    {% block meta %}{% endblock %}
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon" />
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon" />
    <link rel="stylesheet" href="{% static 'styles/bootstrap.min.css' %}" media="all" />
    <link rel="stylesheet" href="{% static 'styles/default.css' %}" />
    <link rel="stylesheet" href="{% static 'styles/load.css' %}" media="none" onload="if(media!='all')media='all'" />
    <link rel="stylesheet" href="{% static 'styles/player_skin/vkontakte.css' %}" media="none" onload="if(media!='all')media='all'" />
    <script>
    function on(elSelector,eventName,selector,fn) {var element = document.querySelector(elSelector);element.addEventListener(eventName, function(event) {var possibleTargets = element.querySelectorAll(selector);var target = event.target;for (var i = 0, l = possibleTargets.length; i < l; i++) {var el = target;var p = possibleTargets[i];while(el && el !== element) {if (el === p) {return fn.call(p, event);}el = el.parentNode;}}});};
    var ready = (callback) => {if (document.readyState != "loading") callback();else document.addEventListener("DOMContentLoaded", callback);}
  </script>
</head>
  <body class="fixed-header sidebar-left-close">
    <div class="wrapper">
        <div class="col-md-1"></div>
        <div class="col-md-10">
        </div>
        <div class="col-md-1"></div>

				<span class="main-container col-xs-12 col-md-12 text-hide-xs jambotron-fluid" style="display:flex !important;flex-wrap: wrap;padding-right:0px;padding-left:0px;">
          <div class="col-md-1"></div>
					<div class="col-md-2">
            <style>
              .faqnav .ajax{
                padding-bottom: 0.6rem;
              }
            </style>
            <div class="col-auto sidebar-inner position-relative ">
                <br>
                <div class="nav flex-column nav-pills faqnav">
                      Нужно <a href="{% url 'main' %}" style="text-decoration:underline;" class="ajax"> войти </a> или
                      <a href="{% url 'main' %}" style="text-decoration:underline;" class="ajax">
                        создать аккаунт
                      </a>
                      для полного доступа к функциям сайта
                </div>
            </div>
 					</div>
            <div class="col-md-7" id="ajax" style="padding-right:0px;padding-left:0px;">
              <span id="reload_block">
          	   {% block content %}
          	   {% endblock %}

               {% include "base_block/fullscreens.html" %}
              </span>
					   </div>
					<div class="col-md-2"></div>
				</span>
    </div>

    {% load staticfiles %}

    <script defer src="{% static 'scripts/jquery.js' %}" type="text/javascript"></script>
    <!--<script defer src="{% static 'scripts/popper.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/bootstrap.min.js' %}" type="text/javascript"></script>-->
    <script defer src="{% static 'scripts/cockie.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/websocketbridge.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/lazysizes.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/get.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/community_get.js' %}" type="text/javascript"></script>

    <script>
    function list_load(block,link) {var request = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject( 'Microsoft.XMLHTTP' );request.open( 'GET', link, true );request.onreadystatechange = function () {if ( request.readyState == 4 && request.status == 200 ) {block.innerHTML = request.responseText;}};request.send( null );}

    ready(() => {
    function addStyleSheets (href) {$head = document.head,$link = document.createElement('link');$link.rel = 'stylesheet';$link.href = href;$head.appendChild($link);};addStyleSheets("/static/styles/color/" + "{% if request.user.color_settings.color %}{{ request.user.color_settings.color }}{% else %}white{% endif %}" + ".css");


    class Index {
      static initLink() {document.body.querySelectorAll('.ajax').forEach( lin => lin.addEventListener('click', Index.push_url) );}

      static push_url(event){
        event.preventDefault();
        var ajax_link = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject( 'Microsoft.XMLHTTP' );
        var url = this.getAttribute('href')
        ajax_link.open( 'GET', url, true );
          ajax_link.send();
          ajax_link.onreadystatechange = function () {
            if ( this.readyState == 4 && this.status == 200 ) {
              var rtr = document.getElementById('ajax');
              var elem_ = document.createElement('span');
              elem_.innerHTML = ajax_link.responseText;
              var ajax = elem_.querySelector("#reload_block");
              rtr.innerHTML = '';
              document.title = elem_.querySelector('title').innerHTML;
              rtr.append(ajax);
              Index.initLink();
              window.history.pushState({route: url}, "network", url);
              if(rtr.querySelector('#news_load')){
                var news_load = rtr.querySelector('#news_load');var link = news_load.getAttribute("data-link");
                list_load(rtr.querySelector("#news_load"), link);
              }else if(rtr.querySelector('#lenta_load')){
                var lenta_load = rtr.querySelector('#lenta_load');var link = lenta_load.getAttribute("data-link");
                list_load(rtr.querySelector("#lenta_load"), link);
              }else if(rtr.querySelector('#lenta_community')){
                var lenta_community = rtr.querySelector('#lenta_community');var link = lenta_community.getAttribute("data-link");
                list_load(rtr.querySelector("#lenta_community"), link);
              }
            }
          }
      };
    }

    Index.initLink();

    rrr = document.getElementById('ajax');
    if(rrr.querySelector('#news_load')){
      var news_load = rrr.querySelector('#news_load');var link = news_load.getAttribute("data-link");
      list_load(rrr.querySelector("#news_load"), link);
    }else if(rrr.querySelector('#lenta_load')){
      var lenta_load = rrr.querySelector('#lenta_load');var link = lenta_load.getAttribute("data-link");
      list_load(rrr.querySelector("#lenta_load"), link);
    }else if(rrr.querySelector('#lenta_community')){
      var lenta_community = rrr.querySelector('#lenta_community');var link = lenta_community.getAttribute("data-link");
      list_load(rrr.querySelector("#lenta_community"), link);
    }
  });

  document.body.querySelectorAll('.drop').forEach( lin => lin.addEventListener('click', function(){
    var block = this.nextElementSibling;
    block.classList.toggle("show");
  }))
    </script>

  </body>
</html>
