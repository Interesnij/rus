{% load staticfiles %}
<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{% block title %}{% endblock %}</title>
    {% block meta %}{% endblock %}
    <link rel="shortcut icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon" />
    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon" />
    <link rel="stylesheet" href="{% static 'styles/bootstrap.min.css' %}" media="all" />
    <link rel="stylesheet" href="{% static 'styles/color/purplesidebar.css' %}"  />
    <link rel="stylesheet" href="{% static 'styles/player_skin/vkontakte.css' %}"  />
    <script src="{% static 'scripts/jquery.js' %}" type="text/javascript"></script>
    <script src="{% static 'scripts/ajax.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'scripts/jquery.jplayer.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'scripts/jplayer.playlist.min.js' %}" type="text/javascript"></script>

    <style>
    @media screen and (max-width: 620px) {
       .gadget-only{
        display: none;
        }
        .desc-only{
          display: visible;
        }
    }
    @media screen and (min-width: 621px) {
       .desc-only{
        display: visible;
      }
    }
    a {
      color: inherit;
    }
    @media screen and (min-width: 621px) {
       .activefullscreen{
         left: 20%;
         width: 60%;
         padding-left: 5%;
         padding-right: 5%;
      }
    }
    </style>
  <body class="fixed-header sidebar-left-close">
    <div class="wrapper">

        <div class="col-md-1 desc-only"></div>
        <div class="col-md-10 desc-only">
          {% include "base_block/navbar.html" %}
        </div>
        <div class="col-md-1 desc-only"></div>

        {% if user.is_authenticated %}
        <span class="d-sm-none d-block">
          {% include "base_block/mobile_nav.html" %}
        </span>
        {% endif %}

							<span class="main-container col-xs-12 col-md-12 text-hide-xs jambotron-fluid" style="display:flex !important;flex-wrap: wrap;padding-right:0px;padding-left:0px;">
                <div class="col-md-1 col-xs-0 gadget-only"></div>
								<div class="{% if request.user.is_anonymous %}col-md-2{% endif %} gadget-only">
 								  {% include 'base_block/desctop_nav.html' %}
 								</div>
                  <div class="col-md-7" id="ajax" style="padding-right:0px;padding-left:0px;">

                	   {% block content %}
                	   {% endblock %}

                     {% include "base_scripts.html" %}
                     <span id="music_json_list"></span>
								   </div>

								<div class="col-md-2 gadget-only"></div>

							</span>
    </div>

    {% include "base_block/footer.html" %}

    {% include "generic/gallery/photo_popover.html" %}
    <script defer src="{% static 'scripts/popper.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/bootstrap.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/jquery.cookie.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/cockie.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/websocketbridge.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/lazysizes.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/jquery.waypoints.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/infinite.min.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/frend_follow.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/music.js' %}" type="text/javascript"></script>
    <script defer src="{% static 'scripts/jquery.toast.min.js' %}" type="text/javascript"></script>

<script>
  var cssSelector = {jPlayer: "#jquery_jplayer_1",cssSelectorAncestor: ".main-header"};
  var playlist = {{ request.user.my_playlist }};
  var options = { swfPath: "/static/jquery.jplayer.swf", supplied: "oga, mp3", wmode: "window", smoothPlayBar: false, keyEnabled: true};
  var myPlaylist = new jPlayerPlaylist(cssSelector, playlist, options);

  $('#ajax').on('click', '#tag_playlist .track_item', function() {
      track = $(this); track_id = track.data('counter'); playlist_block = $('body').find('.music-dropdown'); tag_pk = track.parent().parent().parent().data('pk');
      if (!playlist_block.hasClass('tag_' + tag_pk)){
      $.ajax({
        url: "/music/manage/temp_tag/" + tag_pk + "/",
        success: function(data) { playlist_block.html('').load("/users/load/playlist/" + '{{ request.user.uuid }}' + "/");playlist_block.addClass('tag_' + tag_pk)}
      });}else{myPlaylist.play(track_id)};

    });

    $('#ajax').on('click', '#user_playlist .tracks-container .track_item', function() {
        track = $(this); track_id = track.data('counter'); playlist_block = $('body').find('.music-dropdown'); tag_pk = track.parent().parent().parent().data('pk');
        if (!playlist_block.hasClass('my_playlist')){
        $.ajax({
          url: "/music/manage/my_list/",
          success: function(data) { playlist_block.html('').load("/users/load/playlist/" + '{{ request.user.uuid }}' + "/");playlist_block.addClass('my_playlist')}
        });}else{myPlaylist.play(track_id)};

      });
</script>
  </body>
</html>
