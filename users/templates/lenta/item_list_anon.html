{% load staticfiles humanize thumbnail %}

{% if items_list %}

<div class="card mb-4 item_fullscreen" style="display:none">
  <span class="item_fullscreen_hide">
    <img style="width:35px" src="{% static 'images/icons/close-24px.svg' %}" />
  </span>
    <div id="item_loader" style="margin-top:30px;position: relative;"></div>
</div>
<div class="lenta-container">
    <div class="stream-update">
        <a href=""><span class="new-posts"></span> Загрузить новые записи</a>
    </div>

    <span class="stream">

        {% if object.article %}
        {% include 'item_user/article.html' with article=article %}
        {% endif %}

        {% if object.post %}
        {% include 'item_user/post.html' with post=post  %}
        {% endif %}

        {% for object in items_list %}

        {% if object.article %}
        {% include 'item_user/article.html' with article=article  %}
        {% endif %}

        {% if object.post %}
        {% include 'item_user/post.html' with post=post  %}
        {% endif %}

        {% endfor %}
    </span>

</div>
<div class="items-load col-12 col-md-12">
    {% if items_list.has_next %}
    <a style="display:flex;justify-content:center;" class="infinite-more-link" href="{% url 'user_item_list' user.pk %}?page={{ items_list.next_page_number }}">
        <img src="{% static 'images/loading.gif' %}">
    </a>
    {% endif %}

</div>

{% else %}
<div class="card mb-4 post_empty" style="align-items: center;justify-content:center;">
  <div class="card-body">
  <svg fill="currentColor" class="thumb_big svg_default" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path fill="currentColor" d="M22 13h-8v-2h8v2zm0-6h-8v2h8V7zm-8 10h8v-2h-8v2zm-2-8v6c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V9c0-1.1.9-2 2-2h6c1.1 0 2 .9 2 2zm-1.5 6l-2.25-3-1.75 2.26-1.25-1.51L3.5 15h7z"/></svg>
  </div>
  <h6 style="margin-bottom: 20px;"> Пока записей нет...</h6>
</div>
{% endif %}


<script>
$('#ajax .stream').on('click', '.article_detail', function() {
    var item = $(this); var item_id = item.data("id");
    $('#article_loader').html('').load("/article/detail/" + item_id); $('.article_fullscreen').show();
});
$('#ajax').on('click', '.fullscreen', function() {
    var item = $(this); var item_pk = item.data("pk"); var user_uuid = item.data("uuid");
    $('#item_loader').html('').load("/users/detail/item/" + item_pk + "/" + user_uuid + "/"); $('.item_fullscreen').show();
});
$('#ajax').on('click', '.c_fullscreen', function() {
    var item = $(this); var pk = item.data("pk"); var uuid = item.data("uuid");
    $('#item_loader').html('').load("/communities/item/" + pk + "/" + uuid + "/"); $('.item_fullscreen').show();
});

$('.user_page').on('click', '.avatar_detail', function() {
		var photo = $(this); var photo_id = photo.data("id"); var user_uuid = photo.data("uuid");
		$('#photo_loader').html('').load("/gallery/load/avatar_detail/" + photo_id + "/" + user_uuid + "/"); $('.photo_fullscreen').show();
});
$('.photo_fullscreen_hide').on('click', function() { $('.photo_fullscreen').hide(); $('#photo_loader').empty(); });
$('.item_fullscreen_hide').on('click', function() { $('.item_fullscreen').hide(); $('#item_loader').empty(); });
$('.article_fullscreen_hide').on('click', function() {$('.article_fullscreen').hide(); $('#article_loader').empty();});

$('#ajax').on('click', '.show_replies', function() { var element = $(this); element.next().toggleClass('replies_open'); });

$('#ajax').on('click', '.u_comment.comments_close', function() {
    var btn = $(this); var item = btn.closest(".infinite-item"); var uuid = item.attr("item-id"); var pk = btn.data('pk'); var container = item.find(".load_comments")
    $.ajax({
        url: "/user/comment/" + uuid + "/" + pk + "/", data: {'uuid': uuid}, cache: false,
        beforeSend: function() { item.find(".load_comments").html("<span style='display:flex;justify-content: center;'><img src='/static/images/loading.gif'></span>"); },
        success: function(data) { container.html(data.comments); btn.addClass("comments_open").removeClass("comments_close")}
    }); return false;
});
$('#ajax').on('click', '.u_comment.comments_open', function() {
  var btn = $(this); var item = btn.closest(".infinite-item"); var container = item.find(".load_comments"); container.empty(); btn.removeClass('comments_open').addClass("comments_close");
});
$('#ajax').on('click', '.js-textareacopybtn', function() {
  btn = $(this);
  link = btn.find('.js-copytextarea');
  link.focus();
  link.select();
  console.log(link)
try {
  var successful = document.execCommand('copy');
  var msg = successful ? 'successful' : 'unsuccessful';
  console.log('Copying text command was ' + msg);
} catch (err) {
  console.log('Oops, unable to copy');
}
});
</script>
