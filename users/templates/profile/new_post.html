{% load staticfiles %}

{% if user == request.user %}
<div class="card mb-4" style="border:1px solid rgba(0, 0, 0, 0.125);">
    <form action="" id="form_post" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="card-body p-0">
            <textarea name="text" id="id_text" class="id_text form-control bg-light-secondary border-0" rows="2" placeholder="Что у Вас нового?"></textarea>
        </div>

        {% include 'generic/posts/form_footer.html' %}

    </form>
</div>

{% endif %}
<div class="card mb-4 article_fullscreen" style="display:none">
    <span class="article_fullscreen_hide">
        <img style="width:35px" src="{% static 'images/icons/close-24px.svg' %}" />
    </span>
    <div id="article_loader" style="margin-top:30px">

    </div>
</div>

<script>
    $('.article_fullscreen_hide').on('click', function() {
        $('.article_fullscreen').hide();
        $('#article_loader').empty();
    });
</script>

<script>
    $("#article_add").click(function() {
        $('#article_loader').html('').load("{% url 'article_add_user' pk=user.pk %}");
        $('.article_fullscreen').show();
    })
</script>

<script>
  $("#form_post_btn").click(function() {
    var form_post = $('#form_post');
        $.ajax({
            type: form_post.attr('method'),
            url: "{% url 'post_add_user' pk=user.pk %}",
            data: form_post.serialize(),
            success: function(data) {
                $(".stream").prepend(data);
                $(".id_text").val("");
                $(".add_board #for_images_upload").hide();
                $(".add_board #for_gallery").hide();
                $(".add_board #for_doc").hide();
                $(".add_board #for_good").hide();
                $(".add_board #for_question").hide();
                $(".add_board #for_settings").hide();
                $.toast({
                    heading: '{{ request.user.first_name }}',
                    text: 'Запись успешно создана!',
                    showHideTransition: 'fade',
                    icon: 'success'
                })
            },
            error: function(data) {
                $.toast({
                    heading: '{{ request.user.first_name }}',
                    text: 'Для публикации записи нужно написать что-нибудь и/или вставить изображение(ия)',
                    showHideTransition: 'fade',
                    icon: 'error'
                })
            }

        });
        return false;
    });
</script>
