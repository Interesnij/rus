{% extends "base.html" %}
{% block title %}Сообщения{% endblock %}
{% load messager %}
{% block content %}

<div class="container main-container">
<div class="row">
    <div class="col-md-8 mt-3">
        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Поиск сообщений">
            <div class="input-group-append">
                <button class="btn btn-outline-link" type="button">Искать</button>
            </div>
        </div>

        <div class="card mb-2">
            <div class="card-body px-0 py-0">
              {% if object_list %}

              <ul class="list-group profile_block_paginate" id="messages_container">
                  {% for object in object_list %}

                  {% with message=object.get_first_message %}
                  <li class="list-group-item pag {% if forloop.last %}last{% endif %}">
                    <div class="media">
                      <figure>
                        {% if message.creator.user.get_avatar %}
                          <img src="{{ message.creator.user.get_avatar }}" style="border-radius:50px;width:50px;" alt="image">
                        {% else %}
                          <svg fill="currentColor" class="svg_default svg_default_50" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                        {% endif %}
                      </figure>
                      <div class="media-body">
                        <h5 class="time-title mb-0">{{ message.creator }} ({{ object|get_unread_count:request.user.pk }})
                          {% if message.creator.user.get_online %}
                            <span class="status bg-success"></span>
                          {% endif %}
                          <small class="float-right text-muted">{{ message.get_created }}</small>
                        </h5>
                        <p class="mb-0">{{ object.get_preview }}</p>
                      </div>
                      {{ object|get_unread_count:request.user.pk }}
                    </div>
                  </li>
                  {% endwith %}
                  {% endfor %}
              </ul>

              {% else %}
              <div class="card message_empty centered">
                <div class="card-body"></div>
                <h6 style="margin: 20px;text-align: center;"> Пока сообщений нет... Вы можете создать
                <span class="create_private_chat pointer underline">приватный</span> или <span class="create_public_chat pointer underline"> публичный</span> чат</h6>
              </div>
              {% endif %}

            </div>
        </div>
    </div>

    <div class="col-12 col-md-4">

    </div>
</div>
</div>
{% endblock %}
