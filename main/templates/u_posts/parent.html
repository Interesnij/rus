{% load liked_user %}

<div class="card mb-3 pag {% if forloop.last %}last{% endif %}" data-uuid="{{ object.parent.uuid }}" data-pk="{{ object.parent.creator.pk }}">
  <div class="card-header">
      <div class="media">
        <a href="{% url 'user' pk=object.parent.creator.pk %}" class="ajax">
          <figure>
            {% if object.parent.creator.get_avatar %}
              <img src="{{ object.parent.creator.get_avatar }}" style="border-radius:50px;width:50px;" alt="image">
            {% else %}
              <svg fill="currentColor" class="svg_default svg_default_50" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
            {% endif %}
          </figure>
        </a>
          <div class="media-body">
              <h6 class="mb-0">
                <a href="{% url 'user' pk=object.parent.creator.pk %}" class="ajax">
                  {{ object.parent.creator.get_full_name }} &nbsp;
                </a>
              </h6>
              <p class="mb-0">{{ object.parent.get_created }}</p>
          </div>

          <div class="dropdown">
            <a class="icon-circle icon-30 btn_default drop pointer">
              <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
            </a>
              <div class="dropdown-menu dropdown-menu-right">
                  <span class="dropdown-item js-textareacopybtn">Скопировать ссылку
                    <textarea style="opacity: 0;height:1px;width:1px" class="js-copytextarea">http://трезвый.рус{% url 'user_item_detail' uuid=object.parent.uuid %}</textarea>
                  </span>
                  <span class="dropdown-item post_claim">Пожаловаться</span>
              </div>
          </div>
      </div>
  </div>

  <div class="fullscreen pointer">
      <p class="">{{ object.parent.text }}</p>
  </div>

  <div class="attach_container" data-pk="{{ object.pk }}">
    {% for photo in objec.parent.item_photo.all %}
    <div class="photo">
        <img photo-uuid="{{ photo.uuid }}" data-pk="{{ object.parent.creator.pk }}" class="u_WA_photo image_fit lazyload" style="cursor:pointer" data-src="{{ photo.file.url }}" alt="img">
    </div>
    {% endfor %}
    {% for video in object.parent.item_video.all %}
    <div class="video">
        <img class="image_fit lazyload" data-src="{{ video.image.url }}" alt="img">
        <div class="video_icon_play_v2 u_video_detail" data-pk="{{ object.parent.creator.pk }}" data-uuid="{{ object.uuid }}" video-counter="{{ forloop.counter0 }}"></div>
    </div>
    {% endfor %}
    {% for good in object.parent.item_good.all %}
    <div class="u_good_detail good" good-uuid="{{ good.uuid }}" style="cursor:pointer" data-pk="{{ object.parent.creator.pk }}">
      <span class="badge badge-primary mb-2" style="position:absolute;bottom:-8px;">
        <svg style="padding-bottom: 1px" height="13" fill="#FFFFFF" viewBox="0 0 24 24" width="13"><path d="M0 0h24v24H0z" fill="none"/><path d="M17.21 9l-4.38-6.56c-.19-.28-.51-.42-.83-.42-.32 0-.64.14-.83.43L6.79 9H2c-.55 0-1 .45-1 1 0 .09.01.18.04.27l2.54 9.27c.23.84 1 1.46 1.92 1.46h13c.92 0 1.69-.62 1.93-1.46l2.54-9.27L23 10c0-.55-.45-1-1-1h-4.79zM9 9l3-4.4L15 9H9zm3 8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>
        {{ good.title }}
      </span>
      {% if good.image %}
        <img class="image_fit lazyload" data-src="{{ good.image.url }}" alt="img">
      {% else %}
        <svg class="image_fit svg_default" fill="currentColor" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>
      {% endif %}
    </div>
    {% endfor %}
    {% for item in object.parent.attached_item.all %}
    <div class="article" data-uuid="{{ item.uuid }}" data-pk="{{ object.parent.creator.pk }}">
      <span class="badge badge-info mb-2" style="position: absolute;bottom:-8px;">
        <svg style="padding-bottom: 1px" height="13" fill="#FFFFFF" viewBox="0 0 24 24" width="13"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
        {{ item.title}}
      </span>
      <div class="text-center u_article_detail" style="cursor:pointer">
        <div class="align-items-center">
            {% if item.g_image %}
              <img class="lazyload image_fit" data-src="{{ item.g_image.url }}" alt="img">
            {% else %}
              <img class="lazyload image_fit" data-src="/static/images/no-image.jpg" />
            {% endif %}
        </div>
     </div>
    </div>
    {% endfor %}
    {% for music in object.parent.item_music.all %}
      {% include 'attach/music.html' %}
    {% endfor %}
  </div>


  <div class="card-footer border-top py-2">
      <div class="row">
          <div class="col interaction" id="interaction">
            <span {% if not object.parent.votes_on %}style="display:none"{% endif %} class="like u_like {% if object.parent.likes|user_in:request.user %}btn_success{% else %}btn_default{% endif %}" title="Нравится">
              <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24">
                <path fill="none" d="M0 0h24v24H0V0z"/><path d="M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z"/>
              </svg>
              <span class="likes_count" data-count="like">
                {% if object.parent.likes.count %}{{ object.parent.likes.count }}{% endif %}
              </span>
            </span>

            <span class="like_window">
              {% if object.parent.window_likes %}
            <div class="like_pop">
              <span class="u_all_posts_likes pointer">Оценили: <span data-count="like">{{ object.parent.likes.count }}</span> {{ object.parent.likes.count|rupluralize:"человек,человека,людей" }}</span>
              <span style="display: flex;margin-top: 10px;">
                {% for heart in object.parent.window_likes %}
                <a href="{% url 'user' pk=heart.user.pk %}" class="ajax" style="padding-right:10px" data-pk="{{ heart.user.pk }}">
                  <figure style="margin: 0;" title="{{ heart.user.get_full_name }}">
                    {% if heart.user.get_avatar %}
                      <img src="{{ heart.user.get_avatar }}" style="border-radius: 50px;width:50px;" alt="image">
                    {% else %}
                      <svg fill="currentColor" class="svg_default svg_default_50" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                    {% endif %}
                  </figure>
                </a>
                {% endfor %}
              </span>
            </div>
            {% endif %}
          </span>
          <span {% if not object.parent.votes_on %} style="display:none"{% endif %} class="dislike u_dislike {% if object.parent.dislikes|user_in:request.user %}btn_danger{% else %}btn_default{% endif %}" title="Не нравится">
                <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z"/></svg>
                <span class="dislikes_count">{% if object.parent.dislikes.count %}{{ object.parent.dislikes.count }}{% endif %}</span>
          </span>

          <span class="dislike_window">
            {% if object.parent.window_dislikes %}
          <div class="dislike_pop">
            <span class="u_all_posts_dislikes pointer">Не оценили: <span data-count="dislike">{{ object.parent.dislikes.count }}</span> {{ object.parent.dislikes.count|rupluralize:"человек,человека,людей" }}</span>
            <span style="display: flex;margin-top: 10px;">
              {% for sheet in object.parent.window_dislikes %}
              <a href="{% url 'user' pk=sheet.user.pk %}" class="ajax" style="padding-right:10px" data-pk="{{ sheet.user.pk }}">
                <figure style="margin: 0;" title="{{ sheet.user.get_full_name }}">
                  {% if sheet.user.get_avatar %}
                    <img src="{{ sheet.user.get_avatar }}" style="border-radius: 50px;width:50px;" alt="image">
                  {% else %}
                    <svg fill="currentColor" class="svg_default svg_default_50" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                  {% endif %}
                  </figure>
                </a>
                {% endfor %}
              </span>
          </div>
          {% endif %}
          </span>
              <span title="Комментарий" class="u_item_comments btn_default" style="cursor:pointer;margin-right: 5px;{% if not object.parent.comments_enabled %}display:none{% endif %}">
                <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                  <span class="comment-count">
                      {% if object.parent.count_comments %}{{ object.parent.count_comments }}{% endif %}
                  </span>
              </span>
              <span title="Поделиться" class="u_ucm_post_repost btn_default pointer">
                <svg class="svg_info" fill="currentColor" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/></svg>
                  <span class="repost-count">
                    {% if object.parent.count_reposts %}
                    {{ object.parent.count_reposts }}
                    {% endif %}
                  </span>
              </span>
              <span class="repost_window">
                {% if object.parent.get_window_reposts %}
              <div class="repost_pop">
                <span class="u_all_item_reposts pointer">Поделились: {{ object.parent.count_reposts }} {{ object.parent.count_reposts|rupluralize:"человек,человека,людей" }}</span>
                <br><br>
                <span style="display: flex;margin-top: 10px;">
                  {% for repost in object.parent.get_window_reposts %}
                  <a href="{% url 'user' pk=repost.creator.pk %}" class="ajax" style="padding-right:10px">
                    <figure style="margin: 0;" title="{{ sheet.user.get_full_name }}">
                      {% if repost.creator.get_avatar %}
                        <img src="{{ repost.creator.get_avatar }}" style="border-radius: 50px;width:50px;" alt="image">
                      {% else %}
                        <svg fill="currentColor" class="svg_default svg_default_50" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
                      {% endif %}
                      </figure>
                    </a>
                    {% endfor %}
                  </span>
              </div>
              {% endif %}
              </span>
          </div>
          <span class="col-auto" title="Просмотры" style="font-size:12px">
            <svg fill="currentColor" class="svg_info svg_default" style="width:17px" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              {{ object.parent.all_visits_count }}
          </span>
      </div>

      <div class="u_load_comments"></div>
  </div>

</div>
