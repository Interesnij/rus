{% extends "base_reload.html" %}
{% load staticfiles humanize %}

{% block title %}{{ object.name }}{% endblock %}
{% block content %}

{% if not object.is_private or member %}
{% include 'detail/navbar.html' %}

<div class="container mt-4 main-container">
    <div class="row">
        <div class="col-12 col-md-12 col-lg-8">

          {% if object.is_public or member %}
            {% include 'detail/new_post.html' %}

            <div id="lenta_load"></div>

          {% else %}
            Только подписчики сообщества могут просматривать записи
          {% endif %}
        </div>
        <div class="col-12 col-md-12 col-lg-4">

            {% if membersheeps %}
            {% include 'detail/membersheeps.html' %}
            {% endif %}

            {% include 'detail/forum.html' %}

        </div>

    </div>
</div>
{% else %}
<div class="container mt-4 main-container">
    <div class="row" style="margin-top: 100px;display: flex;align-items: center;justify-content: center;">
      Это приватное сообщество. Доступ возможен только по приглашению администрации сообщества.
    </div>
</div>
{% endif %}

<script>
  var ready = (callback) => {
  if (document.readyState != "loading") callback();
  else document.addEventListener("DOMContentLoaded", callback);
  }
  ready(() => {
    var link = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject( 'Microsoft.XMLHTTP' );
    link.open( 'GET', '/communities/list/' + '{{ community.pk }}', true );
    link.onreadystatechange = function () {
      if ( link.readyState == 4 ) {
          if ( link.status == 200 ) {
              var lenta_load = document.getElementById("lenta_load");
              lenta_load.innerHTML = link.responseText;
          }
      }
  };
  link.send( null );
  });
</script>
{% endblock %}
